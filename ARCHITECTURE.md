# ðŸ—ï¸ Architecture Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BROWSER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    React App (Port 3000)               â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚            Redux Store (Global State)          â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  User Slice  â”‚    â”‚ Theme Slice  â”‚         â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ - currentUserâ”‚    â”‚ - mode       â”‚         â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ - isAuth     â”‚    â”‚ - light/dark â”‚         â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚      React Query (Server State Cache)          â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Posts   â”‚  â”‚   Post   â”‚  â”‚ Comments â”‚    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Cache   â”‚  â”‚  Cache   â”‚  â”‚  Cache   â”‚    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚              React Router                       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚   Feed   â”‚  â”‚ Post Detail  â”‚  â”‚ Layout  â”‚ â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚   Page   â”‚  â”‚    Page      â”‚  â”‚ Header  â”‚ â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚              Components Layer                   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ PostCard â”‚  â”‚ Comment  â”‚  â”‚  Forms   â”‚    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚              Services Layer                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚         Axios API Client              â”‚     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  - postsApi.getAllPosts()            â”‚     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  - postsApi.createPost()             â”‚     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  - commentsApi.getCommentsByPostId() â”‚     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ HTTP Requests
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Backend Server (Port 3001)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              JSON Server + Auth                        â”‚  â”‚
â”‚  â”‚                                                         â”‚  â”‚
â”‚  â”‚  REST API Endpoints:                                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  GET    /posts          - Get all posts         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  GET    /posts/:id      - Get single post       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  POST   /posts          - Create new post       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  PATCH  /posts/:id      - Update post (like)    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  GET    /comments       - Get comments           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  POST   /comments       - Create comment         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  PATCH  /comments/:id   - Update comment (like)  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  GET    /users          - Get users              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                               â”‚
â”‚                              â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    db.json (Database)                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  users   â”‚  â”‚  posts   â”‚  â”‚ comments â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Tree

```
App
â”œâ”€â”€ Provider (Redux)
â”‚   â””â”€â”€ QueryClientProvider (React Query)
â”‚       â””â”€â”€ BrowserRouter (React Router)
â”‚           â””â”€â”€ Suspense (Lazy Loading)
â”‚               â””â”€â”€ Routes
â”‚                   â””â”€â”€ Route path="/" element={Layout}
â”‚                       â”œâ”€â”€ Outlet
â”‚                       â”‚   â”œâ”€â”€ Route path="feed"
â”‚                       â”‚   â”‚   â””â”€â”€ FeedPage
â”‚                       â”‚   â”‚       â”œâ”€â”€ NewPostForm
â”‚                       â”‚   â”‚       â”‚   â”œâ”€â”€ useState (title, content, tags)
â”‚                       â”‚   â”‚       â”‚   â”œâ”€â”€ useRef (titleInput)
â”‚                       â”‚   â”‚       â”‚   â””â”€â”€ useMutation (createPost)
â”‚                       â”‚   â”‚       â”‚
â”‚                       â”‚   â”‚       â””â”€â”€ PostCard (for each post)
â”‚                       â”‚   â”‚           â”œâ”€â”€ useSelector (currentUser)
â”‚                       â”‚   â”‚           â””â”€â”€ useMutation (likePost)
â”‚                       â”‚   â”‚
â”‚                       â”‚   â””â”€â”€ Route path="posts/:id"
â”‚                       â”‚       â””â”€â”€ PostDetailPage
â”‚                       â”‚           â”œâ”€â”€ useParams (id)
â”‚                       â”‚           â”œâ”€â”€ useQuery (post)
â”‚                       â”‚           â”œâ”€â”€ useMutation (likePost)
â”‚                       â”‚           â”‚
â”‚                       â”‚           â””â”€â”€ Suspense (lazy)
â”‚                       â”‚               â””â”€â”€ CommentsSection
â”‚                       â”‚                   â”œâ”€â”€ useQuery (comments)
â”‚                       â”‚                   â”œâ”€â”€ CommentForm
â”‚                       â”‚                   â”‚   â”œâ”€â”€ useState (content)
â”‚                       â”‚                   â”‚   â”œâ”€â”€ useRef (textarea)
â”‚                       â”‚                   â”‚   â””â”€â”€ useMutation (createComment)
â”‚                       â”‚                   â”‚
â”‚                       â”‚                   â””â”€â”€ Comment (for each comment)
â”‚                       â”‚                       â”œâ”€â”€ useState (showReply, showReplies)
â”‚                       â”‚                       â”œâ”€â”€ useMutation (likeComment)
â”‚                       â”‚                       â”œâ”€â”€ CommentForm (for reply)
â”‚                       â”‚                       â””â”€â”€ Comment (recursive for replies)
â”‚                       â”‚
â”‚                       â””â”€â”€ Layout (Header)
â”‚                           â”œâ”€â”€ useSelector (theme, currentUser)
â”‚                           â”œâ”€â”€ useDispatch (toggleTheme)
â”‚                           â””â”€â”€ Outlet (renders child routes)
```

## Data Flow Diagrams

### Reading Data (GET)

```
User Action (Page Load)
    â”‚
    â–¼
Component Mount
    â”‚
    â–¼
useQuery Hook
    â”‚
    â”œâ”€â–º Check Cache
    â”‚   â”œâ”€â–º Data exists â†’ Return cached data
    â”‚   â””â”€â–º Data stale/missing â†“
    â”‚
    â–¼
API Service (api.js)
    â”‚
    â–¼
Axios Request
    â”‚
    â–¼
JSON Server (Port 3001)
    â”‚
    â–¼
Read db.json
    â”‚
    â–¼
Return Data
    â”‚
    â–¼
React Query Updates Cache
    â”‚
    â–¼
Component Re-renders
    â”‚
    â–¼
UI Updates
```

### Writing Data (POST/PATCH)

```
User Action (Click Like, Post Comment)
    â”‚
    â–¼
Event Handler
    â”‚
    â–¼
useMutation Hook
    â”‚
    â”œâ”€â–º Optimistic Update (update UI immediately)
    â”‚
    â–¼
API Service (api.js)
    â”‚
    â–¼
Axios Request (POST/PATCH)
    â”‚
    â–¼
JSON Server (Port 3001)
    â”‚
    â–¼
Write to db.json
    â”‚
    â–¼
Return Success
    â”‚
    â–¼
onSuccess Callback
    â”‚
    â–¼
Invalidate Query Cache
    â”‚
    â–¼
React Query Refetches
    â”‚
    â–¼
Component Re-renders with Fresh Data
    â”‚
    â–¼
UI Updates (confirmed from server)
```

### State Management Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Redux Store (Global)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   userSlice                          â”‚   â”‚
â”‚  â”‚   - currentUser: { id, name, ... }  â”‚   â”‚
â”‚  â”‚   - isAuthenticated: true           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   themeSlice                         â”‚   â”‚
â”‚  â”‚   - mode: "light" | "dark"          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                    â”‚
         â”‚                    â”‚
    useSelector          useDispatch
         â”‚                    â”‚
         â”‚                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        Component                 â”‚
    â”‚  const theme = useSelector()    â”‚
    â”‚  const dispatch = useDispatch() â”‚
    â”‚  dispatch(toggleTheme())        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       React Query Cache (Server State)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   ['posts'] â†’ [post1, post2, ...]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   ['post', 1] â†’ { id: 1, title... }â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   ['comments', 1] â†’ [comment1, ...] â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                    â”‚
         â”‚                    â”‚
     useQuery            useMutation
         â”‚                    â”‚
         â”‚                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        Component                 â”‚
    â”‚  const { data } = useQuery()    â”‚
    â”‚  const mutation = useMutation() â”‚
    â”‚  mutation.mutate(data)          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Request/Response Example

### Creating a New Post

**1. User fills form and clicks "Post"**

**2. Frontend (NewPostForm.jsx):**
```javascript
const newPost = {
  title: "My First Post",
  content: "Hello World!",
  authorId: 1,
  author: { id: 1, username: "john_doe", ... },
  createdAt: "2026-01-26T10:00:00Z",
  likes: 0,
  likedBy: [],
  commentCount: 0,
  tags: ["Test", "First"],
};

createPostMutation.mutate(newPost);
```

**3. API Service (api.js):**
```javascript
export const createPost = async (postData) => {
  const response = await axios.post(
    'http://localhost:3001/posts',
    postData
  );
  return response.data;
};
```

**4. HTTP Request:**
```
POST http://localhost:3001/posts
Content-Type: application/json

{
  "title": "My First Post",
  "content": "Hello World!",
  ...
}
```

**5. Backend (JSON Server):**
- Validates request
- Generates ID
- Saves to db.json
- Returns created post

**6. HTTP Response:**
```json
{
  "id": 9,
  "title": "My First Post",
  "content": "Hello World!",
  ...
}
```

**7. Frontend Updates:**
```javascript
onSuccess: (newPost) => {
  // Invalidate cache
  queryClient.invalidateQueries(['posts']);
  
  // Feed automatically refetches and shows new post
}
```

## File Import Dependencies

```
main.jsx
  â””â”€â”€ App.jsx
      â”œâ”€â”€ store.js
      â”‚   â”œâ”€â”€ userSlice.js
      â”‚   â””â”€â”€ themeSlice.js
      â”‚
      â”œâ”€â”€ Layout.jsx
      â”‚   â””â”€â”€ (routes render here)
      â”‚
      â”œâ”€â”€ FeedPage.jsx (lazy)
      â”‚   â”œâ”€â”€ api.js (postsApi)
      â”‚   â”œâ”€â”€ PostCard.jsx
      â”‚   â””â”€â”€ NewPostForm.jsx
      â”‚       â””â”€â”€ api.js (postsApi)
      â”‚
      â””â”€â”€ PostDetailPage.jsx (lazy)
          â”œâ”€â”€ api.js (postsApi)
          â””â”€â”€ CommentsSection.jsx (lazy)
              â”œâ”€â”€ api.js (commentsApi)
              â”œâ”€â”€ Comment.jsx (lazy)
              â”‚   â”œâ”€â”€ api.js (commentsApi)
              â”‚   â””â”€â”€ CommentForm.jsx
              â”‚       â””â”€â”€ api.js (commentsApi)
              â””â”€â”€ CommentForm.jsx
                  â””â”€â”€ api.js (commentsApi)
```

## Lazy Loading Strategy

```
Initial Bundle (main.js)
â”œâ”€â”€ React core
â”œâ”€â”€ Redux store
â”œâ”€â”€ React Query setup
â”œâ”€â”€ App.jsx
â”œâ”€â”€ Layout.jsx
â””â”€â”€ Router setup

Loaded on /feed
â”œâ”€â”€ FeedPage.jsx
â”œâ”€â”€ PostCard.jsx
â””â”€â”€ NewPostForm.jsx

Loaded on /posts/:id
â”œâ”€â”€ PostDetailPage.jsx
â””â”€â”€ (after delay)
    â””â”€â”€ CommentsSection.jsx
        â””â”€â”€ Comment.jsx
```

## Cache Strategy

**React Query Cache Timing:**
```
staleTime: 5 minutes
  â””â”€â”€ Data considered fresh for 5 minutes
      â””â”€â”€ No refetch during this time

cacheTime: 10 minutes
  â””â”€â”€ Data kept in cache for 10 minutes
      â””â”€â”€ After staleTime, can refetch
      â””â”€â”€ After cacheTime, removed from memory

refetchOnWindowFocus: false
  â””â”€â”€ Don't refetch when user returns to tab
```

## Performance Metrics

**Initial Load (uncached):**
- Bundle size: ~150-200 KB (gzipped)
- First paint: < 1 second
- Interactive: < 2 seconds

**Navigation (cached):**
- Page transition: < 100ms
- Data from cache: instant
- New data fetch: < 500ms

**Interactions:**
- Like button: instant (optimistic)
- Post creation: < 1 second
- Comment load: < 500ms (lazy)

---

This architecture provides a scalable, performant, and maintainable structure for the community forum app! ðŸš€
